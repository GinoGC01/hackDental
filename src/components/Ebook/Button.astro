---
// src/components/Button.astro
import Image from 'astro/components/Image.astro';
import ArrowRight from '../../Icons/Ebook/ArrowRight.astro';
import ProfileImage from '../../assets/perfil.svg'

interface Props {
  className?: string;
  subtext?: string;
  fromColor?: string;
  toColor?: string;
  shadowColor?: string;
  textColor?: string;
  useBounce?: boolean;
  useArrow?: boolean;
  colorArrow?: string;
  width?: string;
  mdWidth?: string;
  button?: boolean;
  image?:boolean
}

const { 
  className = '', 
  subtext,
  fromColor = "from-[#16a34a]", 
  toColor = "to-[#15803d]",     
  shadowColor = "shadow-[#064e3b]", 
  textColor = "text-white",
  useBounce = false,
  useArrow = true,
  colorArrow = '#ffffff',
  width = 'w-full max-w-[22em]',
  mdWidth = 'md:max-w-[27em]',
  button = true,
  image = false
} = Astro.props;

const pureShadowColor = shadowColor.match(/\[(.*?)\]/)?.[1] || "#064e3b";
---

{button ? <button
  class={`group relative overflow-hidden
    ${width} ${mdWidth}
    flex flex-col items-center justify-center
    bg-gradient-to-b ${fromColor} ${toColor}
    ${textColor} py-4 px-8
    rounded-lg
    
    /* Tipografía Unificada */
    font-heading tracking-wide
    
    /* Sombras */
    shadow-[0_4px_0_var(--shadow-color),0_10px_15px_rgba(0,0,0,0.3)]
    md:shadow-[0_6px_0_var(--shadow-color),0_15px_20px_rgba(0,0,0,0.4)]
    
    /* Interacciones */
    transition-all duration-300 ease-out
    hover:scale-105 hover:brightness-110
    active:scale-95 active:translate-y-[2px]
    active:shadow-[0_2px_0_var(--shadow-color)]
    
    border-t border-white/20
    cursor-pointer
    m-auto
    ${useBounce ? 'animate-bounce' : ''}
    ${className}`}
  style={`--shadow-color: ${pureShadowColor};`}
  data-popup-trigger
>
  <div class="absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors duration-300 pointer-events-none"></div>

  <div class="shine-element"></div>

  <div class="relative z-30 flex items-center gap-2 md:gap-3 text-lg md:text-2xl uppercase text-shadow-sm whitespace-nowrap pointer-events-none">
    <slot />
    {useArrow && (
      <div class="transition-transform duration-300 group-hover:translate-x-1.5 flex items-center">
        <ArrowRight color={colorArrow} />
      </div>
    )}
  </div>

  {subtext && (
    <span class="relative z-30 text-[10px] md:text-sm font-medium opacity-90 mt-0.5 md:mt-1 block uppercase text-center pointer-events-none flex items-center justify-center gap-2">
      {subtext} {image && <Image src={ProfileImage} alt={''} />}
    </span>
  )}
</button>:
<a href="/contacto"
  target="_blank"
  class={`group relative overflow-hidden
    ${width} ${mdWidth}
    flex flex-col items-center justify-center
    bg-gradient-to-b ${fromColor} ${toColor}
    ${textColor} py-4 px-8
    rounded-lg
    
    /* Tipografía Unificada */
    font-heading tracking-wide
    
    /* Sombras */
    shadow-[0_4px_0_var(--shadow-color),0_10px_15px_rgba(0,0,0,0.3)]
    md:shadow-[0_6px_0_var(--shadow-color),0_15px_20px_rgba(0,0,0,0.4)]
    
    /* Interacciones */
    transition-all duration-300 ease-out
    hover:scale-105 hover:brightness-110
    active:scale-95 active:translate-y-[2px]
    active:shadow-[0_2px_0_var(--shadow-color)]
    
    border-t border-white/20
    cursor-pointer
    m-auto
    ${useBounce ? 'animate-bounce' : ''}
    ${className}`}
  style={`--shadow-color: ${pureShadowColor};`}
  data-popup-trigger
>
  <div class="absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors duration-300 pointer-events-none"></div>

  <div class="shine-element"></div>

  <div class="relative z-30 flex items-center gap-2 md:gap-3 text-lg md:text-2xl uppercase text-shadow-sm whitespace-nowrap pointer-events-none">
    <slot />
    {useArrow && (
      <div class="transition-transform duration-300 group-hover:translate-x-1.5 flex items-center">
        <ArrowRight color={colorArrow} /> 
      </div>
    )}
  </div>

  {subtext && (
    <span class="relative z-30 text-[10px] md:text-sm font-medium opacity-90 mt-0.5 md:mt-1 block uppercase text-center pointer-events-none flex items-center justify-center gap-2">
      {subtext} {image && <span class="w-[18px] h-[18px] md:w-[20px] md:h-[20px] rounded-full overflow-hidden"><Image src={ProfileImage} alt={'Imagen de perfil CEO HackDental'} /></span> }
    </span>
  )}
</a>
}



<style>
  /* Animación Shine Garantizada */
  .shine-element {
    position: absolute;
    top: 0;
    left: -150%;
    height: 100%;
    width: 100%;
    z-index: 20;
    background: linear-gradient(
      to right,
      transparent,
      rgba(255, 255, 255, 0.4),
      transparent
    );
    transform: skewX(-20deg);
    pointer-events: none;
  }

  .group:hover .shine-element {
    animation: shine-effect 0.75s forwards;
  }

  @keyframes shine-effect {
    0% { left: -150%; }
    100% { left: 150%; }
  }

  /* Forzamos que la fuente sea la del token de Oswald */
  .font-heading {
    font-family: 'Oswald', sans-serif !important;
  }
</style>